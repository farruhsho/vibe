# ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ Spotify

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω Client Credentials Flow

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ Spotify API** –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### Client Credentials Flow

```dart
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
static Future<String> getClientCredentialsToken() async {
  final credentials = base64Encode(
    utf8.encode('$clientId:$clientSecret')
  );

  // POST –∑–∞–ø—Ä–æ—Å –∫ Spotify
  final response = await http.post(
    Uri.parse('https://accounts.spotify.com/api/token'),
    headers: {
      'Authorization': 'Basic $credentials',
      'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: {'grant_type': 'client_credentials'},
  );

  // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
  _cachedToken = data['access_token'];
  _tokenExpiry = DateTime.now().add(Duration(seconds: expiresIn));
}
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –Ω–µ –Ω—É–∂–µ–Ω OAuth
‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞** - –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—ç—à
‚úÖ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - —Ç–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏
‚úÖ **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –≤—Å–µ —Ç—Ä–µ–∫–∏, –æ–±–ª–æ–∂–∫–∏, –Ω–∞–∑–≤–∞–Ω–∏—è –∏–∑ Spotify

---

## –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü–æ–∏—Å–∫ –º—É–∑—ã–∫–∏

```dart
// –†–µ–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –≤ Spotify
final results = await SpotifyService.searchTracks(query, limit: 50);

// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞
- ‚úÖ –ò–º—è –∞—Ä—Ç–∏—Å—Ç–∞
- ‚úÖ –û–±–ª–æ–∂–∫–∞ –∞–ª—å–±–æ–º–∞
- ‚úÖ Preview URL (30 —Å–µ–∫)
- ‚úÖ Spotify URI
```

### 2. –ñ–∞–Ω—Ä—ã

```dart
// –ü–æ–∏—Å–∫ –ø–æ –∂–∞–Ω—Ä—É
final tracks = await SpotifyService.searchTracks(genreName, limit: 30);

// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏ –∂–∞–Ω—Ä–∞ –∏–∑ Spotify
```

### 3. Audio Features

```dart
// –ü–æ–ª—É—á–µ–Ω–∏–µ –∞—É–¥–∏–æ-—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
final features = await SpotifyService.getAudioFeatures(trackId);

// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- energy (0-1)
- valence (0-1)
- danceability (0-1)
- tempo (BPM)
- acousticness
- instrumentalness
- key & mode
```

---

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### SpotifyService

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `getClientCredentialsToken()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- `_cachedToken` - –∫—ç—à —Ç–æ–∫–µ–Ω–∞
- `_tokenExpiry` - –≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:**
- `searchTracks()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
- `getAudioFeatures()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
- `getMultipleAudioFeatures()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω

### SearchScreen

**–£–±—Ä–∞–Ω–æ:**
- ‚ùå Mock —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚ùå Fallback –Ω–∞ demo –¥–∞–Ω–Ω—ã–µ
- ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ demo —Ä–µ–∂–∏–º–µ

**–û—Å—Ç–∞–ª–æ—Å—å:**
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ Spotify
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π UI

### GenresScreen

**–£–±—Ä–∞–Ω–æ:**
- ‚ùå –ì–µ–Ω–µ—Ä–∞—Ü–∏—è mock —Ç—Ä–µ–∫–æ–≤
- ‚ùå Placeholder –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–û—Å—Ç–∞–ª–æ—Å—å:**
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –∂–∞–Ω—Ä—É
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –æ–±–ª–æ–∂–∫–∏
- ‚úÖ –ù–∞—Å—Ç–æ—è—â–∏–µ —Ç—Ä–µ–∫–∏

---

## Credentials

```yaml
Client ID: 0c4284170a4f4c68a4834dc317e6bd11
Client Secret: ea6d94c8b0994d7295e49a7171ec5e14

App: vibe
Status: Development Mode
```

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –í production mode –Ω—É–∂–Ω–æ:
1. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ Client Secret –≤ backend
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å PKCE flow –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Authorization Code Flow –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Client Credentials

### –ß—Ç–æ –ú–û–ñ–ù–û:

‚úÖ –ü–æ–∏—Å–∫ —Ç—Ä–µ–∫–æ–≤
‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç—Ä–µ–∫–∞—Ö
‚úÖ Audio features
‚úÖ Album/Artist info
‚úÖ –ü–ª–µ–π–ª–∏—Å—Ç—ã (–ø—É–±–ª–∏—á–Ω—ã–µ)

### –ß—Ç–æ –ù–ï–õ–¨–ó–Ø:

‚ùå –î–æ—Å—Ç—É–ø –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚ùå –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ Spotify
‚ùå –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤
‚ùå –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π Spotify
‚ùå Top tracks –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –†–µ—à–µ–Ω–∏–µ:

–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ:
1. –•—Ä–∞–Ω–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –ª–æ–∫–∞–ª—å–Ω–æ (Firebase)
2. –•—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ª–æ–∫–∞–ª—å–Ω–æ
3. –°–æ–∑–¥–∞–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–ª–µ–π–ª–∏—Å—Ç—ã
4. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å OAuth –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ Spotify

---

## –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é:

1. **–ü–æ–∏—Å–∫**
   - –†–µ–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏ Spotify
   - –û–±–ª–æ–∂–∫–∏ –≤—ã—Å–æ–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
   - –ù–∞–∑–≤–∞–Ω–∏—è –∏ –∞—Ä—Ç–∏—Å—Ç—ã
   - Preview –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è

2. **–ñ–∞–Ω—Ä—ã**
   - 8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∂–∞–Ω—Ä–æ–≤
   - –†–µ–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É
   - –ö—Ä–∞—Å–∏–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏

3. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è**
   - 8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π (chill, energetic, happy, etc.)
   - Mock –¥–∞–Ω–Ω—ã–µ —Å audio features
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

4. **AI –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
   - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### üìù –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ:

- Firebase –¥–ª—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- Firebase –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
- Firebase –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Firebase –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

1. **–ü–æ–∏—Å–∫:**
   ```
   –û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–ü–æ–∏—Å–∫"
   –í–≤–µ—Å—Ç–∏: "rock music"
   –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏
   ```

2. **–ñ–∞–Ω—Ä—ã:**
   ```
   –û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞"
   –í—ã–±—Ä–∞—Ç—å –ª—é–±–æ–π –∂–∞–Ω—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–†–æ–∫")
   –î–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–∫–∏
   ```

3. **Debug logs:**
   ```dart
   ‚úÖ Spotify token –ø–æ–ª—É—á–µ–Ω, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ: 2025-...
   ‚úÖ –ù–∞–π–¥–µ–Ω–æ 50 —Ç—Ä–µ–∫–æ–≤ –¥–ª—è "rock music"
   ```

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞**
   - –¢–æ–∫–µ–Ω –∂–∏–≤—ë—Ç ~1 —á–∞—Å
   - –ù–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ
   - –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ –º–∏–Ω—É—Ç—É –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è

2. **Batch –∑–∞–ø—Ä–æ—Å—ã**
   - `getMultipleAudioFeatures()` –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç—Ä–µ–∫–æ–≤
   - –î–æ 100 —Ç—Ä–µ–∫–æ–≤ –∑–∞ —Ä–∞–∑

3. **Error handling**
   - Graceful degradation
   - –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
   - Retry –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö

---

## –°—Ç–∞—Ç—É—Å

### ‚úÖ –ì–æ—Ç–æ–≤–æ:
- Client Credentials Flow
- –†–µ–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
- –†–µ–∞–ª—å–Ω—ã–µ –∂–∞–Ω—Ä—ã
- Audio features
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- Error handling

### üîÑ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:
- OAuth –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π Spotify (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### ‚ùå –£–±—Ä–∞–Ω–æ:
- Demo —Ä–µ–∂–∏–º
- Mock –¥–∞–Ω–Ω—ã–µ
- Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã

---

## –í—ã–≤–æ–¥

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ Spotify API!**

–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç–æ—è—â–∏–µ —Ç—Ä–µ–∫–∏
- ‚úÖ –ñ–∞–Ω—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω—É—é –º—É–∑—ã–∫—É
- ‚úÖ –û–±–ª–æ–∂–∫–∏ –≤ –≤—ã—Å–æ–∫–æ–º –∫–∞—á–µ—Å—Ç–≤–µ
- ‚úÖ Preview —Ä–∞–±–æ—Ç–∞–µ—Ç (30 —Å–µ–∫)
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏—è –∏ –∞—Ä—Ç–∏—Å—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ

**–ù–∏–∫–∞–∫–∏—Ö mock –¥–∞–Ω–Ω—ã—Ö!** üéâ
